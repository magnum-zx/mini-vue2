{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observe(data) {\r\n\t// 只针对对象劫持\r\n\tif (typeof data !== 'object' || data === null) {\r\n\t\treturn\r\n\t}\r\n\t// 如果一个对象以及被劫持过了，就不需要再次劫持，通过添加__ob__判断\r\n\treturn new Observer(data)\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n\tobserve(value)\r\n\tObject.defineProperty(target, key, {\r\n\t\tget() {\r\n\t\t\treturn value\r\n\t\t},\r\n\t\tset(newValue) {\r\n\t\t\tif (newValue === value) return\r\n\t\t\tvalue = newValue\r\n\t\t},\r\n\t})\r\n}\r\n\r\nclass Observer {\r\n\tconstructor(data) {\r\n\t\t// Object.defineProperty只能劫持已存在的属性（因此需要增加api如 Vue.$set，Vue.$delete等）\r\n\t\tthis.walk(data) // 遍历属性\r\n\t}\r\n\r\n\twalk(data) {\r\n\t\t// 重写对象属性\r\n\t\tObject.keys(data).forEach((key) => defineReactive(data, key, data[key]))\r\n\t}\r\n}\r\n","import { observe } from './observe/index'\r\n\r\nexport function initState(vm) {\r\n\tconst opts = vm.$option\r\n\tif (opts.data) {\r\n\t\tinitData(vm)\r\n\t}\r\n}\r\n\r\nfunction initData(vm) {\r\n\tlet data = vm.$option.data // data可能是函数或者对象\r\n\tdata = typeof data === 'function' ? data.call(vm) : data\r\n\tvm._data = data // 将data挂载到vm上\r\n\r\n\t// 观测数据： 采用Object.defineProperty对数据进行劫持\r\n\tobserve(data)\r\n\r\n\t// 将vm._data 用vm代理\r\n\tfor (let key in data) {\r\n\t\tproxy(vm, '_data', key)\r\n\t}\r\n}\r\n\r\nfunction proxy(vm, target, key) {\r\n\tObject.defineProperty(vm, key, {\r\n\t\tget() {\r\n\t\t\treturn vm[target][key]\r\n\t\t},\r\n\t\tset(newValue) {\r\n\t\t\tif (vm[target][key] === newValue) return\r\n\t\t\tvm[target][key] = newValue\r\n\t\t},\r\n\t})\r\n}\r\n","// 做一些初始化操作\r\nimport { initState } from './state.js'\r\nexport function initMixin(Vue) {\r\n\tVue.prototype._init = function (options) {\r\n\t\t// vm.$options 就是获取用户的配置\r\n\t\tconst vm = this\r\n\t\tvm.$option = options // 将用户的options 挂载到实例上\r\n\r\n\t\t// 初始化状态\r\n\t\tinitState(vm)\r\n\t}\r\n}\r\n","// 打包入口文件\r\n\r\nimport { initMixin } from './init'\r\n\r\nfunction Vue(options) {\r\n\tthis._init(options)\r\n}\r\n\r\ninitMixin(Vue) // 扩展init方法\r\n\r\nexport default Vue\r\n"],"names":["observe","data","Observer","defineReactive","target","key","value","Object","defineProperty","get","set","newValue","walk","keys","forEach","initState","vm","opts","$option","initData","call","_data","proxy","initMixin","Vue","prototype","_init","options"],"mappings":"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"}